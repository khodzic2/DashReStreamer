# DashReStreamer

v0.1.0

DashReStreamer is a framework for generating test video sequences with encoded stall and rate changes. It provides the functionality to reproduce network impact on video player performances by creating video clips including all resolution changes and re-buffering events. We achieve this functionality by utilising video logs generated by the client during the original stream of content in an uncontrolled environment (i.e., real production network).


Authors: Kerim Hodzic <kerim.hodzic@etf.unsa.ba>, Mirsad Cosovic <mcosovic@etf.unsa.ba>, Sasa Mrdovic <smrdovic@etf.unsa.ba>, Jason J. Quinlan <j.quinlan@cs.ucc.ie>, and Darijo Raca <draca@etf.unsa.ba>.

![](./resources/bbb_ex1.gif)

Contents:

- [Requirements](#requirements)
- [Installation](#installation)
- [Usage](#usage)
- [Example](#example)
- [Caveats](#caveats)
- [Dataset](#dataset)



## Requirements

- Python 3.6 or higher
- FFmpeg:
    - download a static build from [their website](http://ffmpeg.org/download.html))
    - put the `ffmpeg` executable in your `$PATH`
    
    

## Installation

Clone the repository
	git clone 

Install Dependencies

	pip install -r requirements.txt
	
	
## Usage

	Usage:
	
	scenario with config file: 
	
	python video_log_merger.py --parameter_type config --config_path <input>
	
	scenario with sending parameters from terminal and downloading segments via mpd file:
        
	python video_log_merger.py --parameter_type path --log_location mpd --mpd_path <input> --path_to_log <input> --dest_video <input> --gif_path <input> --    final_path <input>
	
        scenario with sending parameters from terminal and segments stored locally:
	
        python video_log_merger.py --parameter_type path --log_location local --path_to_log <input> --path_audio <input> --path_video <input> --dest_video <input> --gif_path <input> --final_path <input>

		[--path_to_log]
		[--log_location] 
		[--rep_lvl_col]
		[--stall_dur_col]
		[--log_separator]
		[--config_path]
		[--cleanup]
		[--auto_scale]
		[--scale_resolution]
		[--mpd_path]
		[--path_audio]
		[--path_video]
		[--log_location]
	
	
	--path_to_log	Path where video log is stored
	--rep_lvl_col	Column name where rep level is stored
	--seg_index_col	Column name where chunk index is stored
	--stall_dur_col	Column name where stall duration is stored
	--log_separator	Separator style, tab or csv
	--path_audio	Full or relative path to where audio files are stored
	--path_video	Full or relative path to where video files are stored
	--dest_video	Full or relative path to working folder
	--gif_path	Full or relative path to gif
	--final_path	Full or relative path to place where to store final video
	--mpd_path	URL where mpd with audio and video is
	--auto_scale	If auto scale option is 0 it is off, if 1 then all video segments are rescaled to resolution of highest quality segment, if 2 aditional parameter scale_resolution is read
	--log_location	local is for locally downloaded segments, mpd link is to download segments from server, where full link is sent as parameter
	--parameter_type	Specifies how parameters are sent to script - path for sending parameters in console while calling script, and config for seting parameters in .ini file
	--config_path	Path to where .ini config file is stored
	--cleanup	If True all files except final video in dest_video deleted
	--scale_resolution	720p, 1080p, 1440p or 2160p, auto_scale should be set to 2
	
## Example 

	python video_log_merger.py --parameter_type config --config_path resources/config.ini
	

This is example of how to run a script with scenario of segments downloaded from server using mpd file, using config file to send parameters, and **config.ini**, **gif.gif**, and **log.txt** stored in <resources> folder. Paths to them are send as relative paths. In general case, if files and folder are not in the working folder use apsolute paths as parameters. Cleanup is <True> so all intermediate files except final video is deleted. If  intermediate files are needed for analysis, set cleanup parameter as <False>. MPD URL: <http://cs1dev.ucc.ie/misl/4K_non_copyright_dataset/4_sec/x264/bbb/DASH_Files/full/dash_video_audio.mpd>. For other scenarios user can also send parameters from path, or specify paths to where segments are stored locally.


## Caveats

- DashReStreamer is tested on video content splited in physical segments (profile full).
- Software is tested with following video datasets: <https://www.ucc.ie/en/misl/research/datasets/ivid_dataset/> and <https://www.ucc.ie/en/misl/research/datasets/ivid_uhd_dataset/>. (support for YouTube videos implemented in new version)
- TODO: add support for byte range DASH content (implemented in new version)


## Dataset

We provide an extensive dataset containing video sequences created over 3G, 4G and WiFi networks. In total, 234 video sequences were generated with a duration of 5 minutes. The dataset contains video logs and bandwidth traces used for the video sequence generation. These video sequences are suitable for subjective QoE evaluation, and can aid in the better understanding of user experience in different scenarios. Dataset can be found at: <https://shorturl.at/dtISV>


## Docker Container of DashReStreamer

A docker container of DashReStreamer is available, please read the build/install/run instructions in the docker folder. 
	
V 0.3 improvements
- Support for YouTube videos
- byte range DASH content MPD file supported
- Module for objective metrics calculation (PSNR, SSSIM, MS-SSSIM, VMAF - with different models) implemented
- code refactored and bugs fixed
